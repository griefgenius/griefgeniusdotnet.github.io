<script>
        // --- 1. SIGNATURE ---
        console.log("%c grief genius \n %c log off, tune down, lock in. ", "font-size: 20px; font-weight: bold; background: #F2F0E9;", "color: #69b400;");

        // --- 2. CONFIG ---
        const PALETTE = {
            KERMIT: '#69b400',       
            CELESTIAL: '#088ec9',    
            INK: '#1A1A1A'        
        };

        // --- 3. MAIN HLSF (BACKGROUND) ---
        const mainCanvas = document.getElementById('hlsf-canvas');
        const mainCtx = mainCanvas.getContext('2d');
        let width, height;
        let time = 0;

        function resize() {
            width = mainCanvas.width = window.innerWidth;
            height = mainCanvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        function drawPoly(ctx, x, y, radius, sides, level, maxLevels, rotationOffset, colorA, colorB, lineWidthFactor, opacityFactor) {
            if (level > maxLevels || radius < 1) return;

            ctx.beginPath();
            const angleStep = (Math.PI * 2) / sides;
            
            for (let i = 0; i < sides; i++) {
                const theta = i * angleStep + rotationOffset;
                const px = x + Math.cos(theta) * radius;
                const py = y + Math.sin(theta) * radius;
                if (i === 0) ctx.moveTo(px, py);
                else ctx.lineTo(px, py);
            }
            ctx.closePath();
            
            ctx.strokeStyle = level % 2 === 0 ? colorA : colorB;
            ctx.lineWidth = lineWidthFactor / level; 
            ctx.globalAlpha = opacityFactor / Math.pow(level, 0.6); 
            ctx.stroke();

            if (level < maxLevels) {
                const nextRadius = radius * 0.33; 
                for (let i = 0; i < sides; i++) {
                    const theta = i * angleStep + rotationOffset;
                    const nextX = x + Math.cos(theta) * radius;
                    const nextY = y + Math.sin(theta) * radius;
                    drawPoly(ctx, nextX, nextY, nextRadius, sides, level + 1, maxLevels, rotationOffset * -0.9, colorA, colorB, lineWidthFactor, opacityFactor);
                }
            }
        }

        // --- 4. MINI HLSF (BUTTON) ---
        const btnCanvas = document.getElementById('btn-canvas');
        const btnCtx = btnCanvas.getContext('2d');
        let btnTime = 0;
        let btnSpeed = 0.005; 

        function animate() {
            // A. MAIN CANVAS
            mainCtx.clearRect(0, 0, width, height);
            time += 0.0003; 
            const cx = width / 8;
            const cy = height / 8;
            
            drawPoly(mainCtx, cx, cy, Math.min(width, height) * 0.40, 8, 1, 2, time, PALETTE.CELESTIAL, PALETTE.KERMIT, 28, 0.7);
            drawPoly(mainCtx, cx, cy, Math.min(width, height) * 0.45, 8, 1, 1, -time * 1.5, PALETTE.CELESTIAL, PALETTE.KERMIT, 28, 0.7);

            // B. BUTTON CANVAS
            btnCtx.clearRect(0, 0, 100, 100);
            btnTime += btnSpeed;
            
            drawPoly(btnCtx, 50, 50, 40, 6, 1, 3, btnTime, PALETTE.INK, PALETTE.KERMIT, 2, 1.0);
            
            requestAnimationFrame(animate);
        }
        animate();

        // --- 5. RANDOM SOUND ENGINE ---
        const playBtn = document.getElementById('play-trigger');
        const sounds = ['sounds/click.mp3', 'sounds/glitch.wav', 'sounds/static.mp3']; 
        
        playBtn.addEventListener('click', () => {
            btnSpeed = 0.05; 
            setTimeout(() => { btnSpeed = 0.005; }, 500); 

            if (!sounds.length) return;
            const audio = new Audio(sounds[Math.floor(Math.random() * sounds.length)]);
            audio.play();
        });

        // --- 6. FEED ENGINE (LINKED TO YOUR FORM) ---
        const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS_-ll6bQFpl9Sw1ppGxJ-eiRXfDnCHCRrST9s5IAbsu8kZ4uX0h7kub3og6rImPDA3pekJryE961Uw/pub?gid=84760283&single=true&output=csv';

        async function loadFeed() {
            try {
                const res = await fetch(sheetUrl);
                const txt = await res.text();
                const rows = txt.split('\n').slice(1);
                const box = document.getElementById('feed-container');
                box.innerHTML = '';
                
                rows.forEach(r => {
                    // Smart Splitter
                    const c = r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                    if(c.length < 5) return; 
                    
                    const clean = t => t ? t.replace(/^"|"$/g, '').trim() : "";
                    
                    // --- MAPPING FORM RESPONSES ---
                    // [0]=Timestamp, [1]=Untitled Question, [2]=Title, [3]=Link, [4]=Desc, [5]=Date
                    
                    const title = clean(c[2]); 
                    let link = clean(c[3]);    
                    const desc = clean(c[4]);  
                    // If Date (Col 5) is empty, use the Timestamp (Col 0)
                    const date = clean(c[5]) || clean(c[0]).split(' ')[0]; 

                    // HTTPS Fixer
                    if (link && !link.match(/^https?:\/\//) && link.includes('.')) {
                        link = 'https://' + link;
                    }

                    const html = `
                        <div class="entry">
                            <div class="entry-date">${date}</div>
                            <div class="entry-title"><a href="${link}" target="_blank">${title}</a></div>
                            <div class="entry-desc">${desc}</div>
                        </div>
                    `;
                    
                    if(title && link) box.innerHTML += html;
                });
            } catch(e) { 
                console.log(e);
                document.getElementById('loading').innerText = 'signal lost.'; 
            }
        }
        loadFeed();
    </script>
